# 基于大语言模型的游戏NPC决策与交互系统（随机地牢版）
LLM-Driven NPC Decision-Making and Interaction System (Procedural Dungeon Edition)

---

# 中文版本

## 项目简介
本项目是作为河南农业大学某学生本科毕业设计开发的核心系统，基于 Unity 2021.3.32f1c1 引擎与 C# 编程语言实现，紧密围绕论文题目《基于大语言模型的游戏 NPC 决策与交互设计》的研究核心展开。项目以随机生成式地牢游戏为应用载体，核心研究大语言模型（LLM）在游戏非玩家角色（NPC）智能决策与自然交互中的工程化应用，解决传统 NPC 依赖预设脚本、无法根据玩家输入和游戏情境灵活响应的痛点。

## 支持 Unity 版本
Unity 2021.3.32f1c1

## 核心功能
### 一、LLM 驱动的 NPC 决策与交互核心模块
1.  角色敏感提示模板设计
2.  结构化决策输出与容错机制
3.  上下文闭环集成
4.  对话反馈与剧情驱动机制

### 二、随机地牢生成模块
1.  基于 BFS 算法的地牢生成
2.  房间类型智能分配
3.  地牢状态实时管理

### 三、基础游戏与交互支撑模块
1.  玩家交互控制
2.  战斗与事件响应
3.  编辑器与可视化工具
4.  系统集成与优化

## 目前已实现部分
1.  开始游戏后会自动生成一次地牢
2.  地牢会设定最远的两个房间作为出生点和Boss房，玩家会自动复活在出生点
3.  通过RoomsFirstDungeonGenerator中的按钮可以测试地牢生成和物品放置功能
4.  WASD控制玩家移动，进入战斗房间（怪物房和Boss房）会限制玩家离开，目前按ESC可退出 战斗状态
5.  完成 LLM 与游戏系统的初步集成，实现 NPC 基础对话交互框架

## 更新日志 | Update Log
- 26/2/22：完成核心地牢生成、房间类型分配、战斗状态基础逻辑；完成 LLM 与游戏系统的初步集成，搭建 NPC 对话交互框架

## 鸣谢 & 资源引用
本项目使用了以下外部公开资源与教程，在此表示感谢：

1.  地牢美术素材
    https://pixel-poem.itch.io/dungeon-assetpuck

2.  地牢生成算法参考教程
    https://github.com/SunnyValleyStudio/Unity_2D_Procedural_Dungoen_Tutorial

3.  角色美术素材
    https://brullov.itch.io/generic-char-asset

## 免责声明
1.  本项目仅用于学习、毕业设计与非商业用途。
2.  项目所使用的外部素材、算法与教程均来自网络公开渠道，使用者需自行遵守原作者对应的授权协议与使用规范，如需商用请务必单独联系原作者获取正式授权。
3.  本项目基于 Unity 2021.3.32f1c1 开发，其他版本可能存在兼容问题；LLM 相关功能需依赖对应大模型 API 或本地部署环境。
4.  使用者自行承担使用本项目代码所产生的任何风险，作者不承担任何责任。
5.  如需二次分发，请保留鸣谢与原项目信息。

---

# Japanese Version

## プロジェクト概要
本プロジェクトは河南農業大学の某学生の卒業設計として開発されたコアシステムで、Unity 2021.3.32f1c1エンジンとC#プログラミング言語に基づいて実現されています。論文题目「大言語モデルに基づくゲームNPCの意思決定とインタラクション設計」の研究コアに密接に関連し、ランダム生成型ダンジョンゲームをアプリケーションキャリアとして、大言語モデル（LLM）のゲーム非プレイヤーキャラクター（NPC）のインテリジェント意思決定と自然なインタラクションにおけるエンジニアリング応用を核心的に研究し、伝統的なNPCがプリセットスクリプトに依存し、プレイヤーの入力とゲームシナリオに応じて柔軟に応答できない課題を解決します。

## 対応Unityバージョン
Unity 2021.3.32f1c1

## 主な機能
### 一、LLM駆動のNPC意思決定とインタラクションコアモジュール
1.  キャラクター感受性プロンプトテンプレート設計
2.  構造化意思決定出力とエラー許容メカニズム
3.  コンテキストクローズドループ統合
4.  ダイアログフィードバックとストーリー駆動メカニズム

### 二、ランダムダンジョン生成モジュール
1.  BFSアルゴリズムに基づくダンジョン生成
2.  部屋タイプのスマート割り当て
3.  ダンジョン状態のリアルタイム管理

### 三、基礎ゲームとインタラクションサポートモジュール
1.  プレイヤーインタラクション制御
2.  バトルとイベント応答
3.  エディターとビジュアライゼーションツール
4.  システム統合と最適化

## 実装済み機能
1.  ゲーム開始時にダンジョンが自動生成される
2.  ダンジョン内で最も距離の遠い2つの部屋が、スタート地点とボスルームに設定され、プレイヤーはスタート地点に自動で復活する
3.  RoomsFirstDungeonGeneratorのボタンから、ダンジョン生成とアイテム配置のテストが可能
4.  WASDキーでプレイヤー移動、バトルルーム（モンスタールーム/ボスルーム）に入るとプレイヤーの退出が制限され、ESCキーでバトル状態を退出可能
5.  LLMとゲームシステムの初步的な統合を完成し、NPCの基礎的なダイアログインタラクションフレームワークを実現

## 更新履歴 | Update Log
- 26/2/22：コアダンジョン生成、部屋タイプ割り当て、バトル状態の基本ロジックを完成；LLMとゲームシステムの初步的な統合を完成し、NPCダイアログインタラクションフレームワークを構築

## 謝辞＆外部リソース
本プロジェクトは以下の公開リソース・チュートリアルを参考に制作されています。

1.  ダンジョンアセット素材
    https://pixel-poem.itch.io/dungeon-assetpuck

2.  ダンジョン生成アルゴリズム参考
    https://github.com/SunnyValleyStudio/Unity_2D_Procedural_Dungoen_Tutorial

3.  キャラクターアセット素材
    https://brullov.itch.io/generic-char-asset

## 免責事項
1.  本プロジェクトは学習、卒業設計および非商用目的でのみ使用してください。
2.  利用している外部素材、アルゴリズム、チュートリアルはすべて公開情報です。利用者は各自で元作者のライセンスに従う義務があり、商用利用する場合は必ず原作者に事前に許可を取得してください。
3.  本プロジェクトは Unity 2021.3.32f1c1 で動作確認済み。その他のバージョンでは互換性が保証されません；LLM関連機能は対応する大言語モデルAPIまたはローカルデプロイ環境に依存します。
4.  本コードを使用したことによるいかなる損害についても、作者は責任を負いません。
5.  再配布する場合は、謝辞と原作者情報を保持してください。